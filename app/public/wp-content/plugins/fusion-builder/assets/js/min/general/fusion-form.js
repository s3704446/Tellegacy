window.fusionForms={onLoad:function(){var e=jQuery("body").hasClass("fusion-builder-live");setTimeout(function(){window.fusionForms.calcSelectArrowDimensions()},100),jQuery(".fusion-form-recaptcha-v2").length&&window.fusionForms.renderRecaptcha(),window.fusionForms.calcTooltipWidth(),e||jQuery("#fusion-form-preview").length||jQuery("body").hasClass("awb-generating-critical-css")||jQuery.each(jQuery(".fusion-form-builder"),function(e,r){window.fusionForms.ajaxUpdateView(this)})},onReady:function(){window.fusionForms.startFlatpickr(),jQuery(".fusion-form-range-field-container").on("change input",function(e){var r=jQuery(e.target),i=parseInt(r.attr("max")),t=parseInt(r.attr("min")),o=parseInt(r.val()),n=r.hasClass("fusion-form-range-value")?".fusion-form-input":".fusion-form-range-value";(o<t||o>i)&&(o=o<t?t:i,r.val(o)),r.siblings(n).val(o)}),jQuery(".fusion-form-upload-field-button").on("click",function(e){e.preventDefault(),jQuery(this).closest(".fusion-form-upload-field-container").find('input[type="file"]').trigger("click")}),jQuery('.fusion-form-upload-field-container input[type="file"]').on("change",function(){window.fusionForms.fileUploadChange(this)}),jQuery(".form-form-submit").on("click",function(e){window.fusionForms.hiddenFields(e,this),window.fusionForms.submitClick(e,this)}),jQuery("form.fusion-form").on("submit",function(e){window.fusionForms.submitForm(e,this)}),jQuery("body").on("click",".fusion-alert .close",function(e){e.preventDefault(),jQuery(this).parent().slideUp()}),jQuery(".fusion-form-field input, .fusion-form-field textarea").on("blur",function(){var e=jQuery(this).closest(".fusion-form-field");e.hasClass("error")&&this.checkValidity()&&e.removeClass("error")}),jQuery(".fusion-form-upload-field").on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){jQuery(this).addClass("focused")}).on("dragleave dragend drop",function(){jQuery(this).removeClass("focused")}).on("drop",function(e){var r=e.originalEvent.dataTransfer.files;jQuery(this).find('input[type="file"]').prop("files",r).trigger("change")})},startFlatpickr:function(){jQuery('.fusion-form-field input[type="date"]').each(function(){var e=jQuery(this),r=e.attr("data-type"),i=e.attr("data-format"),t="custom"===r;"native"!==r&&(i=void 0===i||""===i?"Y-m-d":i,e.flatpickr({allowInput:!0,disableMobile:t,dateFormat:i}))}),jQuery('.fusion-form-field input[type="time"]').each(function(){var e=jQuery(this),r=e.attr("data-type"),i="custom"===r,t="full"===e.attr("data-clock");"native"!==r&&e.flatpickr({allowInput:!0,disableMobile:i,enableTime:!0,noCalendar:!0,dateFormat:t?"H:i":"h:i K",time_24hr:t})})},renderRecaptcha:function(){var e;jQuery.each(jQuery(".fusion-form-recaptcha-v2"),function(r,i){e=jQuery(this).attr("id"),grecaptcha.render(e,{sitekey:jQuery(this).data("sitekey"),type:jQuery(this).data("type"),theme:jQuery(this).data("theme")})})},calcTooltipWidth:function(){jQuery.each(jQuery(".fusion-form-tooltip-content"),function(e,r){var i;jQuery(r).closest(".fusion-form-tooltip").css({position:"inherit"}),i=jQuery(r).width()+23,jQuery(r).css({width:i+"px"}),jQuery(r).closest(".fusion-form-tooltip").removeAttr("style")})},calcSelectArrowDimensions:function(){jQuery(".fusion-form-select-wrapper .select-arrow").filter(":visible").each(function(){0<jQuery(this).prev().innerHeight()&&jQuery(this).css({height:jQuery(this).prev().innerHeight(),width:jQuery(this).prev().innerHeight(),"line-height":jQuery(this).prev().innerHeight()+"px"})})},withinViewport:function(e){var r=e.offset().top,i=r+e.outerHeight(),t=jQuery(window).scrollTop(),o=t+jQuery(window).height();return i>t&&r<o},submitClick:function(e,r){var i,t=jQuery(r).closest("form.fusion-form"),o=jQuery(r).data("form-number"),n=jQuery(".fusion-form-form-wrapper.fusion-form-"+o).data("config"),a=[];"default"!==n.form_type&&(e.preventDefault(),t.find('[data-holds-private-data="true"]').each(function(e,r){a.push(r.name)}),t.find('[name="fusion-fields-hold-private-data"]').length||t.append('<input type="hidden" name="fusion-fields-hold-private-data" value="'+a.join(",")+'">'),setTimeout(function(){i=new CustomEvent("fusion-form-before-submit",{detail:{event:e,form:t,formConfig:n}}),window.dispatchEvent(i),t.trigger("submit")},50))},hiddenFields:function(e,r){jQuery(r).closest("form.fusion-form").find(".fusion-form-field-hidden").find("input, textarea, select").attr("required",!1)},submitForm:function(e,r){var i=jQuery(r),t=i.find(".form-form-submit").data("form-number"),o=jQuery(".fusion-form-form-wrapper.fusion-form-"+t).data("config"),n=i.find('[data-fusion-is-honeypot="true"]'),a=i.find("[data-awb-fieldset-min-required], [data-awb-fieldset-max-required]");if("default"!==o.form_type){if(e.preventDefault(),i.find(".fusion-form-field.error").removeClass("error"),a.each(function(e,r){window.fusionForms.checkCustomRequiredCheckboxNum(jQuery(r))||window.fusionForms.insertCustomRequiredCheckboxMessage(jQuery(r))}),!i[0].checkValidity())return i[0].reportValidity(),void i.find("input:invalid, textarea:invalid").each(function(){jQuery(this).closest(".fusion-form-field").addClass("error")});(n=n.filter(function(e,r){return!!jQuery(r).val()})).length?this.revealAlert(i,"error"):0==i.find(".error:not(.fusion-alert)").length&&window.fusionForms.ajaxSubmit(i,o)}},getFormData:function(e,r){var i,t,o=new FormData,n=e.find('input[type="file"]'),a=e.serializeArray(),f=e.parent().data("form-id"),s=[];for(n.length&&n.each(function(){var e=jQuery(this).attr("name").replace("[]",""),r=this.files.length;jQuery.each(this.files,function(i,t){1<r?o.append("files["+e+"@|@"+(i+1)+"]",t):o.append("files["+e+"]",t)})}),jQuery.each(e.find(".fusion-form-field-hidden input, .fusion-form-field-hidden textarea"),function(){var e=jQuery(this).attr("name").replace("[]","");-1===s.indexOf(e)&&s.push(e)}),i=0,t=a.length;i<t;i++)a[i].value=jQuery.trim(a[i].value);return o.append("formData",jQuery.param(a)),o.append("action","fusion_form_submit_form_to_"+r.form_type),o.append("fusion_form_nonce",e.find("#fusion-form-nonce-"+f).val()),o.append("form_id",r.form_id),o.append("post_id",r.post_id),o.append("field_labels",JSON.stringify(r.field_labels)),o.append("hidden_field_names",JSON.stringify(s)),e.find(".fusion-form-recaptcha-v2").length&&o.append("g-recaptcha-response",e.find("#g-recaptcha-response").val()),e.find(".fusion-form-recaptcha-v3").length&&o.append("g-recaptcha-response",e.find(".g-recaptcha-response").val()),"url"===r.form_type&&(o.append("fusionAction",e.attr("action")),o.append("fusionActionMethod",e.attr("method"))),o},ajaxSubmit:function(e,r){var i=this;e.find(".form-form-submit").addClass("fusion-form-working"),jQuery.ajax({type:"POST",url:formCreatorConfig.ajaxurl,data:window.fusionForms.getFormData(e,r),action:"fusion_form_submit_form_to_"+r.form_type,dataType:"json",processData:!1,contentType:!1}).done(function(t){t.captcha||jQuery(e)[0].reset(),"success"==t.status&&"redirect"==r.confirmation_type&&""!==r.redirect_url?window.location=r.redirect_url:i.revealAlert(e,t.status),jQuery(window).trigger("fusion-form-ajax-submit-done",{result:t,formConfig:r})}).fail(function(){i.revealAlert(e,"error"),jQuery(window).trigger("fusion-form-ajax-submit-fail",{formConfig:r})}).always(function(){e.find(".form-form-submit").removeClass("fusion-form-working"),window.fusionForms.reloadCaptcha(e),jQuery(window).trigger("fusion-form-ajax-submitted",{formConfig:r})})},reloadCaptcha:function(e){var r=jQuery(e).closest("form.fusion-form"),i=r.find("div.recaptcha-container").attr("id");void 0!==i&&"undefined"!=typeof active_captcha&&void 0!==active_captcha[i]&&grecaptcha.execute(active_captcha[i],{action:"contact_form"}).then(function(e){r.find("div.recaptcha-container").find(".g-recaptcha-response").val(e)})},revealAlert:function(e,r){var i=e.find(".form-submission-notices"),t=-1!==r.indexOf("error")?"error":r,o=i.find(" > .fusion-form-response-"+t);i.find(".fusion-form-response").hide(),o.length&&(this.withinViewport(i)?(o.attr("role","alert"),o.slideDown(300)):(o.attr("role","alert"),o.css({display:"block"}),jQuery(".fusion-page-load-link").attr("href","#"+i.attr("id")).fusion_scroll_to_anchor_target(30)))},ajaxUpdateView:function(e){jQuery.ajax({type:"POST",url:formCreatorConfig.ajaxurl,data:{action:"fusion_form_update_view",form_id:jQuery(e).data("form-id")},success:function(r){jQuery(e).find(".fusion-form").append(r)},dataType:"html"})},fileUploadChange:function(e){var r=jQuery(e),i=r.val(),t=r.attr("accept"),o=(jQuery(e).prop("files")[0].size/1024/1024).toFixed(4),n=r.data("size"),a=r.closest(".fusion-form-upload-field"),f=i.match(/\.([^\.]+)$/)[1].toLowerCase();if(a.removeClass("error"),1<jQuery(e).prop("files").length){if(i="",jQuery.each(jQuery(e).prop("files"),function(e,s){return o=(s.size/1024/1024).toFixed(4),f=s.name.match(/\.([^\.]+)$/)[1].toLowerCase(),i+=""!==i?", "+s.name.split("\\").pop():s.name.split("\\").pop(),void 0===t||t.toLowerCase().includes(f)?void 0!==n&&o>n?(a.find('input[type="text"]').val(formCreatorConfig.file_size_error+n+"MB"),a.addClass("error"),r.val(""),!1):void 0:(a.find('input[type="text"]').val(formCreatorConfig.file_ext_error+t),a.addClass("error"),r.val(""),!1)}),a.hasClass("error"))return}else{if(i=i.split("\\").pop(),void 0!==t&&!t.toLowerCase().includes(f))return a.find('input[type="text"]').val(formCreatorConfig.file_ext_error+t),a.addClass("error"),void r.val("");if(void 0!==n&&o>n)return a.find('input[type="text"]').val(formCreatorConfig.file_size_error+n+"MB"),a.addClass("error"),void r.val("")}r.closest(".fusion-form-upload-field-container").find(".fusion-form-upload-field").val(i).trigger("change")},checkCustomRequiredCheckboxNum:function(e){var r=e.attr("data-awb-fieldset-min-required"),i=e.attr("data-awb-fieldset-max-required"),t=e.find("input"),o=e.find("input:checked").length,n=t.first();return isNaN(r)&&(r=0),isNaN(i)&&(i=0),(n=n.get(0))&&n.nodeType&&n.setCustomValidity(""),o>=r&&(o<=i||0===parseInt(i))},insertCustomRequiredCheckboxMessage:function(e){var r=e.find("input").first(),i=e.attr("data-awb-fieldset-error");r.length&&(r=r.get(0))&&r.nodeType&&r.setCustomValidity(i)}},function(e){e(window).on("load",function(){window.fusionForms.onLoad()}),e(document).ready(function(){window.fusionForms.onReady()}),e(window).on("fusion-element-render-fusion_form",function(){window.fusionForms.startFlatpickr()})}(jQuery);